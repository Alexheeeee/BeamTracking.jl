using GTPSA

#= Taylor map from a Bmad patch:
    parameter[geometry] = Open
    parameter[particle] = Electron
    beginning[p0c] = 10e6
    p: patch, x_offset = 1, y_offset = 2, z_offset=3, y_pitch = 4, x_pitch = 5, tilt = 6
    lat: line = (p)
    use, lat
=#

d_z = Descriptor(6, 3)
v0_z = [  0.0000000000000000E+00,
          0.0000000000000000E+00,
          0.0000000000000000E+00,
          0.0000000000000000E+00,
          0.0000000000000000E+00,
          0.0000000000000000E+00]
v_z = zeros(TPS64{d_z}, 6)
v_z[1][[0,0,0,0,0,0]] =  3.2764197532680321E+00
v_z[1][[1,0,0,0,0,0]] =  3.3849075973323322E+00
v_z[1][[0,1,0,0,0,0]] =  2.6344283060254877E+01
v_z[1][[0,0,1,0,0,0]] = -3.3306636753001819E+00
v_z[1][[0,0,0,1,0,0]] = -2.5922109870818467E+01
v_z[1][[1,1,0,0,0,0]] =  1.1442730927540044E+01
v_z[1][[0,2,0,0,0,0]] =  8.9057244213999383E+01
v_z[1][[0,1,1,0,0,0]] = -1.3816145597898972E+01
v_z[1][[1,0,0,1,0,0]] = -1.1259358535112701E+01
v_z[1][[0,1,0,1,0,0]] = -1.9515929453414617E+02
v_z[1][[0,0,1,1,0,0]] =  1.3594738690015312E+01
v_z[1][[0,0,0,2,0,0]] =  1.0580603277389820E+02
v_z[1][[0,1,0,0,0,1]] = -2.6344283060254881E+01
v_z[1][[0,0,0,1,0,1]] =  2.5922109870818463E+01
v_z[1][[1,2,0,0,0,0]] =  3.8682323612991112E+01
v_z[1][[0,3,0,0,0,0]] =  3.1423149201051928E+02
v_z[1][[0,2,1,0,0,0]] = -4.6705687522185258E+01
v_z[1][[1,1,0,1,0,0]] = -8.4768118010844432E+01
v_z[1][[0,2,0,1,0,0]] = -1.0362040972863140E+03
v_z[1][[0,1,1,1,0,0]] =  1.0235045007297798E+02
v_z[1][[1,0,0,2,0,0]] =  4.5957218147597992E+01
v_z[1][[0,1,0,2,0,0]] =  1.1674308854581409E+03
v_z[1][[0,0,1,2,0,0]] = -5.5489517425725140E+01
v_z[1][[0,0,0,3,0,0]] = -4.4482854670751129E+02
v_z[1][[1,1,0,0,0,1]] = -1.1442730927540044E+01
v_z[1][[0,2,0,0,0,1]] = -1.7811448842799879E+02
v_z[1][[0,1,1,0,0,1]] =  1.3816145597898972E+01
v_z[1][[1,0,0,1,0,1]] =  1.1259358535112701E+01
v_z[1][[0,1,0,1,0,1]] =  3.9031858906829245E+02
v_z[1][[0,0,1,1,0,1]] = -1.3594738690015312E+01
v_z[1][[0,0,0,2,0,1]] = -2.1161206554779636E+02
v_z[1][[0,1,0,0,0,2]] =  2.6344283060254821E+01
v_z[1][[0,0,0,1,0,2]] = -2.5922109870818431E+01
v_z[2][[0,0,0,0,0,0]] =  8.6074672439468636E-01
v_z[2][[0,1,0,0,0,0]] =  4.7514037893849498E-01
v_z[2][[0,0,0,1,0,0]] =  1.8263815796815633E-01
v_z[2][[0,0,0,0,0,1]] =  8.6074672439468636E-01
v_z[2][[0,2,0,0,0,0]] = -4.3037336219734318E-01
v_z[2][[0,0,0,2,0,0]] = -4.3037336219734396E-01
v_z[2][[0,2,0,0,0,1]] =  4.3037336219734318E-01
v_z[2][[0,0,0,2,0,1]] =  4.3037336219734423E-01
v_z[3][[0,0,0,0,0,0]] =  4.1401549557099839E+00
v_z[3][[1,0,0,0,0,0]] =  9.8502906808898616E-01
v_z[3][[0,1,0,0,0,0]] =  7.6663494781265484E+00
v_z[3][[0,0,1,0,0,0]] = -2.5625920118994840E+00
v_z[3][[0,0,0,1,0,0]] = -1.9944310852867268E+01
v_z[3][[1,1,0,0,0,0]] =  3.3299055462639142E+00
v_z[3][[0,2,0,0,0,0]] =  2.5916209453937476E+01
v_z[3][[0,1,1,0,0,0]] = -4.0205839100617577E+00
v_z[3][[1,0,0,1,0,0]] = -8.6628807511138586E+00
v_z[3][[0,1,0,1,0,0]] = -9.8713708900675741E+01
v_z[3][[0,0,1,1,0,0]] =  1.0459707784141333E+01
v_z[3][[0,0,0,2,0,0]] =  8.1406506579422185E+01
v_z[3][[0,1,0,0,0,1]] = -7.6663494781265484E+00
v_z[3][[0,0,0,1,0,1]] =  1.9944310852867272E+01
v_z[3][[1,2,0,0,0,0]] =  1.1256795668528918E+01
v_z[3][[0,3,0,0,0,0]] =  9.1443309703128534E+01
v_z[3][[0,2,1,0,0,0]] = -1.3591644241837372E+01
v_z[3][[1,1,0,1,0,0]] = -4.2876642618302526E+01
v_z[3][[0,2,0,1,0,0]] = -4.4945727878507171E+02
v_z[3][[0,1,1,1,0,0]] =  5.1769978767725817E+01
v_z[3][[1,0,0,2,0,0]] =  3.5359199125244139E+01
v_z[3][[0,1,0,2,0,0]] =  6.8194791176428646E+02
v_z[3][[0,0,1,2,0,0]] = -4.2693291176121143E+01
v_z[3][[0,0,0,3,0,0]] = -3.4224832993826351E+02
v_z[3][[1,1,0,0,0,1]] = -3.3299055462639142E+00
v_z[3][[0,2,0,0,0,1]] = -5.1832418907874960E+01
v_z[3][[0,1,1,0,0,1]] =  4.0205839100617577E+00
v_z[3][[1,0,0,1,0,1]] =  8.6628807511138586E+00
v_z[3][[0,1,0,1,0,1]] =  1.9742741780135157E+02
v_z[3][[0,0,1,1,0,1]] = -1.0459707784141333E+01
v_z[3][[0,0,0,2,0,1]] = -1.6281301315884434E+02
v_z[3][[0,1,0,0,0,2]] =  7.6663494781265218E+00
v_z[3][[0,0,0,1,0,2]] = -1.9944310852867257E+01
v_z[4][[0,0,0,0,0,0]] =  4.7406406023128056E-01
v_z[4][[0,1,0,0,0,0]] = -6.1755160144504606E-01
v_z[4][[0,0,0,1,0,0]] = -6.2760918281179734E-01
v_z[4][[0,0,0,0,0,1]] =  4.7406406023128056E-01
v_z[4][[0,2,0,0,0,0]] = -2.3703203011564028E-01
v_z[4][[0,0,0,2,0,0]] = -2.3703203011563925E-01
v_z[4][[0,2,0,0,0,1]] =  2.3703203011564028E-01
v_z[4][[0,0,0,2,0,1]] =  2.3703203011563892E-01
v_z[5][[0,0,0,0,0,0]] = -9.2259184283025579E+00
v_z[5][[1,0,0,0,0,0]] = -3.3805150062465921E+00
v_z[5][[0,1,0,0,0,0]] = -2.6310096111393438E+01
v_z[5][[0,0,1,0,0,0]] =  4.0816906224523137E+00
v_z[5][[0,0,0,1,0,0]] =  3.1767252142131209E+01
v_z[5][[0,0,0,0,1,0]] =  1.0000000000000000E+00
v_z[5][[0,0,0,0,0,1]] = -3.7582831391928563E-03
v_z[5][[1,1,0,0,0,0]] = -1.1427881707458397E+01
v_z[5][[0,2,0,0,0,0]] = -9.2833107839684516E+01
v_z[5][[0,1,1,0,0,0]] =  1.3798216400056040E+01
v_z[5][[1,0,0,1,0,0]] =  1.3798216400056052E+01
v_z[5][[0,1,0,1,0,0]] =  2.1477934514738718E+02
v_z[5][[0,0,1,1,0,0]] = -1.6660198337415157E+01
v_z[5][[0,0,0,2,0,0]] = -1.3355552828894406E+02
v_z[5][[0,1,0,0,0,1]] =  2.6310096111393435E+01
v_z[5][[0,0,0,1,0,1]] = -3.1767252142131209E+01
v_z[5][[0,0,0,0,0,2]] =  5.6227426076286184E-03
v_z[5][[1,2,0,0,0,0]] = -4.0322383104797339E+01
v_z[5][[0,3,0,0,0,0]] = -3.2697876218425785E+02
v_z[5][[0,2,1,0,0,0]] =  4.8685922911053439E+01
v_z[5][[1,1,0,1,0,0]] =  9.3290155199654635E+01
v_z[5][[0,2,0,1,0,0]] =  1.1208644510959671E+03
v_z[5][[0,1,1,1,0,0]] = -1.1264010097335297E+02
v_z[5][[1,0,0,2,0,0]] = -5.8010307989799891E+01
v_z[5][[0,1,0,2,0,0]] = -1.3413043545882003E+03
v_z[5][[0,0,1,2,0,0]] =  7.0042620633249243E+01
v_z[5][[0,0,0,3,0,0]] =  5.6101597346471283E+02
v_z[5][[1,1,0,0,0,1]] =  1.1427881707458397E+01
v_z[5][[0,2,0,0,0,1]] =  1.8566621567936903E+02
v_z[5][[0,1,1,0,0,1]] = -1.3798216400056038E+01
v_z[5][[1,0,0,1,0,1]] = -1.3798216400056052E+01
v_z[5][[0,1,0,1,0,1]] = -4.2955869029477441E+02
v_z[5][[0,0,1,1,0,1]] =  1.6660198337415160E+01
v_z[5][[0,0,0,2,0,1]] =  2.6711105657788806E+02
v_z[5][[0,1,0,0,0,2]] = -2.6310096111393385E+01
v_z[5][[0,0,0,1,0,2]] =  3.1767252142131166E+01
v_z[5][[0,0,0,0,0,3]] = -7.4725837049819718E-03
v_z[6][[0,0,0,0,0,1]] =  1.0000000000000000E+00

#=
NOTE: -order value (10) is above order used in calculations which is 3
      Thus the -order value is ignored.
=#